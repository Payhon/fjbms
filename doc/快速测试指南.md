# BMS 模块一 - 快速测试指南

## 🚀 立即开始测试

### 1️⃣ 访问前端应用

**在浏览器中打开**: http://localhost:5002/

前端开发服务器已运行 2+ 小时，状态正常。

---

### 2️⃣ 系统登录

由于这是现有的 ThingsPanel 系统，您需要：

1. **如果已有账号**: 直接使用现有的用户名和密码登录
2. **如果没有账号**: 需要先创建管理员账号

#### 创建管理员账号（如果需要）

使用以下 SQL 在数据库中创建测试账号：

```sql
-- 在 Docker 容器中执行
docker exec -i thingspanel-postgres psql -U postgres -d ThingsPanel << 'EOF'
-- 创建租户
INSERT INTO tenants (id, name, created_at, updated_at) 
VALUES ('test-tenant-001', '测试租户', NOW(), NOW())
ON CONFLICT (id) DO NOTHING;

-- 创建用户 (密码: admin123，已经过 bcrypt 加密)
INSERT INTO users (id, name, email, password, tenant_id, created_at, updated_at)
VALUES (
  'admin-001',
  'BMS测试管理员',
  'admin@test.com',
  '$2a$10$N.zmdr9k7uOCQb376NoUnuTJ8iAt6Z5EHsM8lbmxNsZk3N/6Yr1gC',
  'test-tenant-001',
  NOW(),
  NOW()
)
ON CONFLICT (id) DO NOTHING;

-- 赋予管理员权限
INSERT INTO role_users (user_id, role_id)
VALUES ('admin-001', '1')
ON CONFLICT DO NOTHING;
EOF
```

**登录信息**:
- 邮箱: `admin@test.com`
- 密码: `admin123`

---

### 3️⃣ 访问 BMS 模块

登录成功后：

1. 在左侧导航菜单中找到 **"BMS管理"** 菜单项
2. 展开后会看到三个子菜单：
   - 📋 **经销商管理** (`/bms/dealer`)
   - 🔋 **电池型号管理** (`/bms/battery/model`)
   - 📦 **设备转移记录** (`/bms/battery/transfer`)

---

### 4️⃣ 功能测试清单

#### 经销商管理页面

**基础功能测试**:
- [ ] 页面能否正常加载显示
- [ ] 点击"新增经销商"按钮，弹窗是否显示
- [ ] 填写表单是否正常
- [ ] 表单验证是否工作（必填项）
- [ ] 搜索功能是否可用
- [ ] 分页是否正常

**表单字段**:
- 经销商名称 *（必填）
- 联系人
- 联系电话
- Email
- 省份
- 城市
- 区县
- 详细地址
- 上级经销商（可选）
- 备注

#### 电池型号管理页面

**基础功能测试**:
- [ ] 页面能否正常加载
- [ ] 新增型号弹窗
- [ ] 表单填写和验证
- [ ] 搜索功能
- [ ] 编辑和删除功能

**表单字段**:
- 型号名称 *（必填）
- 额定电压
- 额定容量
- 电芯数量
- 额定功率
- 质保月数
- 描述

#### 设备转移记录页面

**基础功能测试**:
- [ ] 记录列表显示
- [ ] 按设备编号搜索
- [ ] 按经销商筛选
- [ ] 按时间范围筛选
- [ ] 分页功能

---

## ⚠️ 当前限制

### 后端 API 未响应

**状态**: 后端进程运行中，但 HTTP 服务端口（9999）未监听

**影响**: 
- ✅ 前端页面可以正常访问和查看
- ❌ 无法调用后端 API 获取实际数据
- ❌ 无法执行增删改查操作

**表现**:
- 页面加载后，列表可能显示为空
- 点击"新增"、"编辑"等按钮时，会出现网络错误
- 控制台会显示 API 请求失败

### 解决方案

#### 方案 1: 重启后端服务（推荐）

```bash
# 1. 停止当前后端进程
pkill -f "go run main.go"

# 2. 切换到后端目录
cd /Users/payhon/work2025/project/fjbms/backend

# 3. 重新启动（观察启动日志）
go run main.go

# 4. 等待看到 "HTTP server started" 或类似的日志

# 5. 在新终端测试 API
curl http://localhost:9999/api/v1/health
```

#### 方案 2: 使用 Mock 数据测试前端

暂时不调用后端 API，仅测试前端界面的布局和交互。

---

## 🧪 前端 UI 测试（不依赖后端）

即使后端未响应，您仍然可以测试：

### 界面检查

1. **布局和样式**
   - [ ] 页面整体布局是否美观
   - [ ] 表格显示是否正常
   - [ ] 按钮样式是否统一
   - [ ] 响应式设计（调整浏览器窗口大小）

2. **弹窗和表单**
   - [ ] 点击"新增"按钮，弹窗是否正确打开
   - [ ] 表单布局是否整齐
   - [ ] 输入框、下拉框是否正常显示
   - [ ] 关闭弹窗功能

3. **交互反馈**
   - [ ] 按钮悬停效果
   - [ ] 加载状态显示
   - [ ] 错误提示（网络错误）

---

## 📸 测试截图建议

建议截取以下页面截图作为测试记录：

1. **登录页面**
2. **BMS 菜单展开状态**
3. **经销商管理 - 列表页**
4. **经销商管理 - 新增弹窗**
5. **电池型号管理 - 列表页**
6. **电池型号管理 - 新增弹窗**
7. **设备转移记录 - 列表页**
8. **设备转移记录 - 搜索功能**

---

## 🔍 浏览器调试

### 打开开发者工具

按 `F12` 或 `Cmd+Option+I` (Mac) 打开浏览器开发者工具

### 检查项目

1. **Console 标签**
   - 查看是否有 JavaScript 错误
   - 查看 API 请求错误信息

2. **Network 标签**
   - 查看 API 请求状态
   - 确认请求地址是否正确
   - 查看错误响应

3. **Vue DevTools**
   - 地址: http://localhost:5002/__devtools__/
   - 查看组件状态
   - 检查路由配置

---

## ✅ 预期测试结果

### 前端界面测试（应该能完成）

- ✅ 所有页面能正常访问
- ✅ 路由跳转正常
- ✅ 弹窗能正常打开和关闭
- ✅ 表单布局正常
- ✅ UI 组件显示正确

### API 调用测试（需要后端运行）

- ⏸️ 暂时无法测试（等待后端 HTTP 服务修复）
- 待修复后可测试：
  - 列表数据加载
  - 新增、编辑、删除操作
  - 搜索和筛选功能
  - 分页功能
  - 数据验证

---

## 💡 后续步骤

1. **立即操作**:
   - 在浏览器中访问 http://localhost:5002
   - 测试前端界面和交互
   - 记录发现的问题

2. **修复后端**:
   - 重启后端服务
   - 确认 HTTP 端口监听
   - 测试 API 接口

3. **完整测试**:
   - 前后端集成测试
   - 完整业务流程测试
   - 性能测试

---

## 📞 问题反馈

如果在测试过程中遇到问题，请记录：

1. **问题描述**: 详细说明发生了什么
2. **操作步骤**: 如何重现问题
3. **截图**: 问题界面的截图
4. **控制台输出**: 浏览器 Console 中的错误信息
5. **网络请求**: Network 标签中的失败请求

---

**测试愉快！** 🎉

如有问题随时反馈。
